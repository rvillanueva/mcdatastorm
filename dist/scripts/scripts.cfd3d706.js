"use strict";angular.module("mcdatastormApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","angularCharts"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/compare/:id",{templateUrl:"views/compare.html",controller:"CompareCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("mcdatastormApp").controller("MainCtrl",["$scope","yelpAPIFactory",function(a,b){a.location="Chicago",a.businesses=[],a.comparedBusinesses=[],a.chartConfig={title:"Store Comparison",tooltips:!0,labels:!1,mouseover:function(){},mouseout:function(){},click:function(){},legend:{display:!0,position:"right"}},a.chartData={series:["Store Rating","Local Average","Difference"],data:[]},a.search=function(){b.search("McDonalds",a.location,function(b){a.businesses=b.businesses,console.log(a.businesses)})},a.comparedNum=1,a.compare=function(c){console.log(c.location);var d=c.location.coordinate;b.searchCoord(d,"fast food",function(b){a.comparisons=b.businesses,console.log(a.comparisons);for(var d=0,e=0;e<a.comparisons.length;e++)d+=a.comparisons[e].rating;var f=d/a.comparisons.length;console.log(f);var g={x:a.comparedNum+". "+c.location.city,y:[c.rating,f,Math.floor(1e3*(c.rating-f))/1e3]};a.chartData.data.push(g),a.comparedNum++,console.log(a.chartData)})}}]),angular.module("mcdatastormApp").controller("AboutCtrl",["$scope",function(){}]),angular.module("mcdatastormApp").factory("yelpAPIFactory",["$http",function(a){function b(a,b){for(var c="",d=a;d>0;--d)c+=b[Math.round(Math.random()*(b.length-1))];return c}var c=0,d="KJHbaDr-KjZ1FiX6DFqPiE4jNZI",e="GaTyTLFt7LVbHmjDjQkvLujy2MI";return{search:function(f,g,h){var i="http://api.yelp.com/v2/search",j="GET",k={callback:"angular.callbacks._"+c,location:g,term:f,oauth_consumer_key:"GcB4SngYwGokoEd4vofytQ",oauth_token:"LOtGHpo-ADbSyql26pdxayChpq7yuIze",oauth_signature_method:"HMAC-SHA1",oauth_timestamp:(new Date).getTime(),oauth_nonce:b(32,"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ")},l=oauthSignature.generate(j,i,k,d,e,{encodeSignature:!1});return k.oauth_signature=l,c++,a.jsonp(i,{params:k}).success(h)},searchId:function(f,g){var h="http://api.yelp.com/v2/business/"+f,i="GET",j={callback:"angular.callbacks._"+c,oauth_consumer_key:"GcB4SngYwGokoEd4vofytQ",oauth_token:"LOtGHpo-ADbSyql26pdxayChpq7yuIze",oauth_signature_method:"HMAC-SHA1",oauth_timestamp:(new Date).getTime(),oauth_nonce:b(32,"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ")},k=oauthSignature.generate(i,h,j,d,e,{encodeSignature:!1});return j.oauth_signature=k,c++,a.jsonp(h,{params:j}).success(g)},searchCoord:function(f,g,h){var i="http://api.yelp.com/v2/search",j="GET",k={callback:"angular.callbacks._"+c,ll:f.latitude+","+f.longitude,term:g,oauth_consumer_key:"GcB4SngYwGokoEd4vofytQ",oauth_token:"LOtGHpo-ADbSyql26pdxayChpq7yuIze",oauth_signature_method:"HMAC-SHA1",oauth_timestamp:(new Date).getTime(),oauth_nonce:b(32,"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ")},l=oauthSignature.generate(j,i,k,d,e,{encodeSignature:!1});return k.oauth_signature=l,c++,a.jsonp(i,{params:k}).success(h)}}}]),angular.module("mcdatastormApp").controller("CompareCtrl",["$scope","$routeParams","yelpAPIFactory",function(a,b,c){a.params=b,a.targetId=a.params.id,a.target={location:{coordinate:{latitude:41.0298805,longitude:-73.7616272}}},a.avgRating,a.comparisons=[],a.compare=function(){c.searchCoord(a.target.location.coordinate,"fast food",function(b){a.comparisons=b.businesses,console.log(a.comparisons);for(var c=0,d=0;d<a.comparisons.length;d++)c+=a.comparisons[d].rating;a.avgRating=c/a.comparisons.length,console.log(c)})},a.searchId=function(){c.searchId(a.params.id,function(b){a.target=b,console.log(a.target),a.compare()})},a.searchId()}]);